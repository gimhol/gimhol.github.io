!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){var i;i=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t},e.toRadian=function(t){return t*r},e.equals=function(t,e){return Math.abs(t-e)<=i*Math.max(1,Math.abs(t),Math.abs(e))};var i=e.EPSILON=1e-6;e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random;var r=Math.PI/180},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,r,s,o,a,h,u){var c=new i.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=s,c[5]=o,c[6]=a,c[7]=h,c[8]=u,c},e.set=function(t,e,n,i,r,s,o,a,h,u){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=h,t[8]=u,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=c*o-a*u,d=-c*s+a*h,f=u*s-o*h,p=n*l+i*d+r*f;if(!p)return null;return p=1/p,t[0]=l*p,t[1]=(-c*i+r*u)*p,t[2]=(a*i-r*o)*p,t[3]=d*p,t[4]=(c*n-r*h)*p,t[5]=(-a*n+r*s)*p,t[6]=f*p,t[7]=(-u*n+i*h)*p,t[8]=(o*n-i*s)*p,t},e.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=r*u-i*c,t[2]=i*a-r*o,t[3]=a*h-s*c,t[4]=n*c-r*h,t[5]=r*s-n*a,t[6]=s*u-o*h,t[7]=i*h-n*u,t[8]=n*o-i*s,t},e.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8];return e*(u*s-o*h)+n*(-u*r+o*a)+i*(h*r-s*a)},e.multiply=r,e.translate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=n[0],f=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=h,t[6]=d*i+f*o+u,t[7]=d*r+f*a+c,t[8]=d*s+f*h+l,t},e.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*i+d*o,t[1]=f*r+d*a,t[2]=f*s+d*h,t[3]=f*o-d*i,t[4]=f*a-d*r,t[5]=f*h-d*s,t[6]=u,t[7]=c,t[8]=l,t},e.scale=function(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,h=r+r,u=n*o,c=i*o,l=i*a,d=r*o,f=r*a,p=r*h,m=s*o,M=s*a,v=s*h;return t[0]=1-l-p,t[3]=c-v,t[6]=d+M,t[1]=c+v,t[4]=1-u-p,t[7]=f-m,t[2]=d-M,t[5]=f+m,t[8]=1-u-l,t},e.normalFromMat4=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],m=e[13],M=e[14],v=e[15],y=n*a-i*o,g=n*h-r*o,b=n*u-s*o,w=i*h-r*a,x=i*u-s*a,_=r*u-s*h,A=c*m-l*p,S=c*M-d*p,R=c*v-f*p,P=l*M-d*m,L=l*v-f*m,E=d*v-f*M,I=y*E-g*L+b*P+w*R-x*S+_*A;if(!I)return null;return I=1/I,t[0]=(a*E-h*L+u*P)*I,t[1]=(h*R-o*E-u*S)*I,t[2]=(o*L-a*R+u*A)*I,t[3]=(r*L-i*E-s*P)*I,t[4]=(n*E-r*R+s*S)*I,t[5]=(i*R-n*L-s*A)*I,t[6]=(m*_-M*x+v*w)*I,t[7]=(M*b-p*_-v*g)*I,t[8]=(p*x-m*b+v*y)*I,t},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],u=t[6],c=t[7],l=t[8],d=e[0],f=e[1],p=e[2],m=e[3],M=e[4],v=e[5],y=e[6],g=e[7],b=e[8];return Math.abs(n-d)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-f)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(s-p)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-m)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-M)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(h-v)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(u-y)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-g)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-b)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=n[0],f=n[1],p=n[2],m=n[3],M=n[4],v=n[5],y=n[6],g=n[7],b=n[8];return t[0]=d*i+f*o+p*u,t[1]=d*r+f*a+p*c,t[2]=d*s+f*h+p*l,t[3]=m*i+M*o+v*u,t[4]=m*r+M*a+v*c,t[5]=m*s+M*h+v*l,t[6]=y*i+g*o+b*u,t[7]=y*r+g*a+b*c,t[8]=y*s+g*h+b*l,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=s,e.fromValues=o,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=a,e.multiply=h,e.divide=u,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},e.distance=c,e.squaredDistance=l,e.squaredLength=d,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=f,e.dot=p,e.cross=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2];return t[0]=r*h-s*a,t[1]=s*o-i*h,t[2]=i*a-r*o,t},e.lerp=function(t,e,n,i){var r=e[0],s=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t},e.hermite=function(t,e,n,i,r,s){var o=s*s,a=o*(2*s-3)+1,h=o*(s-2)+s,u=o*(s-1),c=o*(3-2*s);return t[0]=e[0]*a+n[0]*h+i[0]*u+r[0]*c,t[1]=e[1]*a+n[1]*h+i[1]*u+r[1]*c,t[2]=e[2]*a+n[2]*h+i[2]*u+r[2]*c,t},e.bezier=function(t,e,n,i,r,s){var o=1-s,a=o*o,h=s*s,u=a*o,c=3*s*a,l=3*h*o,d=h*s;return t[0]=e[0]*u+n[0]*c+i[0]*l+r[0]*d,t[1]=e[1]*u+n[1]*c+i[1]*l+r[1]*d,t[2]=e[2]*u+n[2]*c+i[2]*l+r[2]*d,t},e.random=function(t,e){e=e||1;var n=2*i.RANDOM()*Math.PI,r=2*i.RANDOM()-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t},e.transformMat4=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t},e.transformMat3=function(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t},e.transformQuat=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2],u=n[3],c=u*i+a*s-h*r,l=u*r+h*i-o*s,d=u*s+o*r-a*i,f=-o*i-a*r-h*s;return t[0]=c*u+f*-o+l*-h-d*-a,t[1]=l*u+f*-a+d*-o-c*-h,t[2]=d*u+f*-h+c*-a-l*-o,t},e.rotateX=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},e.rotateY=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},e.rotateZ=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},e.angle=function(t,e){var n=o(t[0],t[1],t[2]),i=o(e[0],e[1],e[2]);f(n,n),f(i,i);var r=p(n,i);return r>1?0:r<-1?Math.PI:Math.acos(r)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=e[0],a=e[1],h=e[2];return Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(s-h)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(){var t=new i.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function s(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function o(t,e,n){var r=new i.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function h(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function u(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function c(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)}function l(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function d(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function f(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}var m;e.sub=a,e.mul=h,e.div=u,e.dist=c,e.sqrDist=l,e.len=s,e.sqrLen=d,e.forEach=(m=r(),function(t,e,n,i,r,s){var o=void 0,a=void 0;for(e||(e=3),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)m[0]=t[o],m[1]=t[o+1],m[2]=t[o+2],r(m,m,s),t[o]=m[0],t[o+1]=m[1],t[o+2]=m[2];return t})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,r){var s=new i.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=s,e.multiply=o,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=h,e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},e.distance=u,e.squaredDistance=c,e.length=l,e.squaredLength=d,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=f,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t[3]=a+i*(n[3]-a),t},e.random=function(t,e){return e=e||1,t[0]=i.RANDOM(),t[1]=i.RANDOM(),t[2]=i.RANDOM(),t[3]=i.RANDOM(),f(t,t),h(t,t,e),t},e.transformMat4=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,t},e.transformQuat=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2],u=n[3],c=u*i+a*s-h*r,l=u*r+h*i-o*s,d=u*s+o*r-a*i,f=-o*i-a*r-h*s;return t[0]=c*u+f*-o+l*-h-d*-a,t[1]=l*u+f*-a+d*-o-c*-h,t[2]=d*u+f*-h+c*-a-l*-o,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-h)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-u)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function a(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function h(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function u(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+s*s)}function c(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return n*n+i*i+r*r+s*s}function l(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)}function d(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function f(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=s*o),t}var p;e.sub=s,e.mul=o,e.div=a,e.dist=u,e.sqrDist=c,e.len=l,e.sqrLen=d,e.forEach=(p=r(),function(t,e,n,i,r,s){var o=void 0,a=void 0;for(e||(e=4),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)p[0]=t[o],p[1]=t[o+1],p[2]=t[o+2],p[3]=t[o+3],r(p,p,s),t[o]=p[0],t[o+1]=p[1],t[o+2]=p[2],t[o+3]=p[3];return t})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var i=d(n(0)),r=d(n(5)),s=d(n(6)),o=d(n(1)),a=d(n(7)),h=d(n(8)),u=d(n(9)),c=d(n(2)),l=d(n(3));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.glMatrix=i,e.mat2=r,e.mat2d=s,e.mat3=o,e.mat4=a,e.quat=h,e.vec2=u,e.vec3=c,e.vec4=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,r){var s=new i.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s},e.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},e.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-r*i;if(!o)return null;return o=1/o,t[0]=s*o,t[1]=-i*o,t[2]=-r*o,t[3]=n*o,t},e.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=r,e.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+s*a,t[1]=r*h+o*a,t[2]=i*-a+s*h,t[3]=r*-a+o*h,t},e.scale=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1];return t[0]=i*a,t[1]=r*a,t[2]=s*h,t[3]=o*h,t},e.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=s,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-h)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-u)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=i*a+s*h,t[1]=r*a+o*h,t[2]=i*u+s*c,t[3]=r*u+o*c,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){var e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,r,s,o){var a=new i.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=s,a[5]=o,a},e.set=function(t,e,n,i,r,s,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=n*s-i*r;if(!h)return null;return h=1/h,t[0]=s*h,t[1]=-i*h,t[2]=-r*h,t[3]=n*h,t[4]=(r*a-s*o)*h,t[5]=(i*o-n*a)*h,t},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=r,e.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=Math.sin(n),c=Math.cos(n);return t[0]=i*c+s*u,t[1]=r*c+o*u,t[2]=i*-u+s*c,t[3]=r*-u+o*c,t[4]=a,t[5]=h,t},e.scale=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=n[0],c=n[1];return t[0]=i*u,t[1]=r*u,t[2]=s*c,t[3]=o*c,t[4]=a,t[5]=h,t},e.translate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=n[0],c=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=i*u+s*c+a,t[5]=r*u+o*c+h,t},e.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],u=e[0],c=e[1],l=e[2],d=e[3],f=e[4],p=e[5];return Math.abs(n-u)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-l)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(o-d)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(h-p)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(p))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=n[0],c=n[1],l=n[2],d=n[3],f=n[4],p=n[5];return t[0]=i*u+s*c,t[1]=r*u+o*c,t[2]=i*l+s*d,t[3]=r*l+o*d,t[4]=i*f+s*p+a,t[5]=r*f+o*p+h,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,r,s,o,a,h,u,c,l,d,f,p,m,M){var v=new i.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=r,v[4]=s,v[5]=o,v[6]=a,v[7]=h,v[8]=u,v[9]=c,v[10]=l,v[11]=d,v[12]=f,v[13]=p,v[14]=m,v[15]=M,v},e.set=function(t,e,n,i,r,s,o,a,h,u,c,l,d,f,p,m,M){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=h,t[8]=u,t[9]=c,t[10]=l,t[11]=d,t[12]=f,t[13]=p,t[14]=m,t[15]=M,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],m=e[13],M=e[14],v=e[15],y=n*a-i*o,g=n*h-r*o,b=n*u-s*o,w=i*h-r*a,x=i*u-s*a,_=r*u-s*h,A=c*m-l*p,S=c*M-d*p,R=c*v-f*p,P=l*M-d*m,L=l*v-f*m,E=d*v-f*M,I=y*E-g*L+b*P+w*R-x*S+_*A;if(!I)return null;return I=1/I,t[0]=(a*E-h*L+u*P)*I,t[1]=(r*L-i*E-s*P)*I,t[2]=(m*_-M*x+v*w)*I,t[3]=(d*x-l*_-f*w)*I,t[4]=(h*R-o*E-u*S)*I,t[5]=(n*E-r*R+s*S)*I,t[6]=(M*b-p*_-v*g)*I,t[7]=(c*_-d*b+f*g)*I,t[8]=(o*L-a*R+u*A)*I,t[9]=(i*R-n*L-s*A)*I,t[10]=(p*x-m*b+v*y)*I,t[11]=(l*b-c*x-f*y)*I,t[12]=(a*S-o*P-h*A)*I,t[13]=(n*P-i*S+r*A)*I,t[14]=(m*g-p*w-M*y)*I,t[15]=(c*w-l*g+d*y)*I,t},e.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],m=e[13],M=e[14],v=e[15];return t[0]=a*(d*v-f*M)-l*(h*v-u*M)+m*(h*f-u*d),t[1]=-(i*(d*v-f*M)-l*(r*v-s*M)+m*(r*f-s*d)),t[2]=i*(h*v-u*M)-a*(r*v-s*M)+m*(r*u-s*h),t[3]=-(i*(h*f-u*d)-a*(r*f-s*d)+l*(r*u-s*h)),t[4]=-(o*(d*v-f*M)-c*(h*v-u*M)+p*(h*f-u*d)),t[5]=n*(d*v-f*M)-c*(r*v-s*M)+p*(r*f-s*d),t[6]=-(n*(h*v-u*M)-o*(r*v-s*M)+p*(r*u-s*h)),t[7]=n*(h*f-u*d)-o*(r*f-s*d)+c*(r*u-s*h),t[8]=o*(l*v-f*m)-c*(a*v-u*m)+p*(a*f-u*l),t[9]=-(n*(l*v-f*m)-c*(i*v-s*m)+p*(i*f-s*l)),t[10]=n*(a*v-u*m)-o*(i*v-s*m)+p*(i*u-s*a),t[11]=-(n*(a*f-u*l)-o*(i*f-s*l)+c*(i*u-s*a)),t[12]=-(o*(l*M-d*m)-c*(a*M-h*m)+p*(a*d-h*l)),t[13]=n*(l*M-d*m)-c*(i*M-r*m)+p*(i*d-r*l),t[14]=-(n*(a*M-h*m)-o*(i*M-r*m)+p*(i*h-r*a)),t[15]=n*(a*d-h*l)-o*(i*d-r*l)+c*(i*h-r*a),t},e.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8],c=t[9],l=t[10],d=t[11],f=t[12],p=t[13],m=t[14],M=t[15];return(e*o-n*s)*(l*M-d*m)-(e*a-i*s)*(c*M-d*p)+(e*h-r*s)*(c*m-l*p)+(n*a-i*o)*(u*M-d*f)-(n*h-r*o)*(u*m-l*f)+(i*h-r*a)*(u*p-c*f)},e.multiply=r,e.translate=function(t,e,n){var i=n[0],r=n[1],s=n[2],o=void 0,a=void 0,h=void 0,u=void 0,c=void 0,l=void 0,d=void 0,f=void 0,p=void 0,m=void 0,M=void 0,v=void 0;e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(o=e[0],a=e[1],h=e[2],u=e[3],c=e[4],l=e[5],d=e[6],f=e[7],p=e[8],m=e[9],M=e[10],v=e[11],t[0]=o,t[1]=a,t[2]=h,t[3]=u,t[4]=c,t[5]=l,t[6]=d,t[7]=f,t[8]=p,t[9]=m,t[10]=M,t[11]=v,t[12]=o*i+c*r+p*s+e[12],t[13]=a*i+l*r+m*s+e[13],t[14]=h*i+d*r+M*s+e[14],t[15]=u*i+f*r+v*s+e[15]);return t},e.scale=function(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,r){var s=r[0],o=r[1],a=r[2],h=Math.sqrt(s*s+o*o+a*a),u=void 0,c=void 0,l=void 0,d=void 0,f=void 0,p=void 0,m=void 0,M=void 0,v=void 0,y=void 0,g=void 0,b=void 0,w=void 0,x=void 0,_=void 0,A=void 0,S=void 0,R=void 0,P=void 0,L=void 0,E=void 0,I=void 0,D=void 0,O=void 0;if(Math.abs(h)<i.EPSILON)return null;s*=h=1/h,o*=h,a*=h,u=Math.sin(n),c=Math.cos(n),l=1-c,d=e[0],f=e[1],p=e[2],m=e[3],M=e[4],v=e[5],y=e[6],g=e[7],b=e[8],w=e[9],x=e[10],_=e[11],A=s*s*l+c,S=o*s*l+a*u,R=a*s*l-o*u,P=s*o*l-a*u,L=o*o*l+c,E=a*o*l+s*u,I=s*a*l+o*u,D=o*a*l-s*u,O=a*a*l+c,t[0]=d*A+M*S+b*R,t[1]=f*A+v*S+w*R,t[2]=p*A+y*S+x*R,t[3]=m*A+g*S+_*R,t[4]=d*P+M*L+b*E,t[5]=f*P+v*L+w*E,t[6]=p*P+y*L+x*E,t[7]=m*P+g*L+_*E,t[8]=d*I+M*D+b*O,t[9]=f*I+v*D+w*O,t[10]=p*I+y*D+x*O,t[11]=m*I+g*D+_*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},e.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],o=e[5],a=e[6],h=e[7],u=e[8],c=e[9],l=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=s*r+u*i,t[5]=o*r+c*i,t[6]=a*r+l*i,t[7]=h*r+d*i,t[8]=u*r-s*i,t[9]=c*r-o*i,t[10]=l*r-a*i,t[11]=d*r-h*i,t},e.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],h=e[3],u=e[8],c=e[9],l=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=s*r-u*i,t[1]=o*r-c*i,t[2]=a*r-l*i,t[3]=h*r-d*i,t[8]=s*i+u*r,t[9]=o*i+c*r,t[10]=a*i+l*r,t[11]=h*i+d*r,t},e.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],h=e[3],u=e[4],c=e[5],l=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=s*r+u*i,t[1]=o*r+c*i,t[2]=a*r+l*i,t[3]=h*r+d*i,t[4]=u*r-s*i,t[5]=c*r-o*i,t[6]=l*r-a*i,t[7]=d*r-h*i,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){var r=n[0],s=n[1],o=n[2],a=Math.sqrt(r*r+s*s+o*o),h=void 0,u=void 0,c=void 0;if(Math.abs(a)<i.EPSILON)return null;return r*=a=1/a,s*=a,o*=a,h=Math.sin(e),u=Math.cos(e),c=1-u,t[0]=r*r*c+u,t[1]=s*r*c+o*h,t[2]=o*r*c-s*h,t[3]=0,t[4]=r*s*c-o*h,t[5]=s*s*c+u,t[6]=o*s*c+r*h,t[7]=0,t[8]=r*o*c+s*h,t[9]=s*o*c-r*h,t[10]=o*o*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromXRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=i+i,h=r+r,u=s+s,c=i*a,l=i*h,d=i*u,f=r*h,p=r*u,m=s*u,M=o*a,v=o*h,y=o*u;return t[0]=1-(f+m),t[1]=l+y,t[2]=d-v,t[3]=0,t[4]=l-y,t[5]=1-(c+m),t[6]=p+M,t[7]=0,t[8]=d+v,t[9]=p-M,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],o=e[5],a=e[6],h=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(n*n+i*i+r*r),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(h*h+u*u+c*c),t},e.getRotation=function(t,e){var n=e[0]+e[5]+e[10],i=0;n>0?(i=2*Math.sqrt(n+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i);return t},e.fromRotationTranslationScale=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3],h=r+r,u=s+s,c=o+o,l=r*h,d=r*u,f=r*c,p=s*u,m=s*c,M=o*c,v=a*h,y=a*u,g=a*c,b=i[0],w=i[1],x=i[2];return t[0]=(1-(p+M))*b,t[1]=(d+g)*b,t[2]=(f-y)*b,t[3]=0,t[4]=(d-g)*w,t[5]=(1-(l+M))*w,t[6]=(m+v)*w,t[7]=0,t[8]=(f+y)*x,t[9]=(m-v)*x,t[10]=(1-(l+p))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,i,r){var s=e[0],o=e[1],a=e[2],h=e[3],u=s+s,c=o+o,l=a+a,d=s*u,f=s*c,p=s*l,m=o*c,M=o*l,v=a*l,y=h*u,g=h*c,b=h*l,w=i[0],x=i[1],_=i[2],A=r[0],S=r[1],R=r[2];return t[0]=(1-(m+v))*w,t[1]=(f+b)*w,t[2]=(p-g)*w,t[3]=0,t[4]=(f-b)*x,t[5]=(1-(d+v))*x,t[6]=(M+y)*x,t[7]=0,t[8]=(p+g)*_,t[9]=(M-y)*_,t[10]=(1-(d+m))*_,t[11]=0,t[12]=n[0]+A-(t[0]*A+t[4]*S+t[8]*R),t[13]=n[1]+S-(t[1]*A+t[5]*S+t[9]*R),t[14]=n[2]+R-(t[2]*A+t[6]*S+t[10]*R),t[15]=1,t},e.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,h=r+r,u=n*o,c=i*o,l=i*a,d=r*o,f=r*a,p=r*h,m=s*o,M=s*a,v=s*h;return t[0]=1-l-p,t[1]=c+v,t[2]=d-M,t[3]=0,t[4]=c-v,t[5]=1-u-p,t[6]=f+m,t[7]=0,t[8]=d+M,t[9]=f-m,t[10]=1-u-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,i,r,s,o){var a=1/(n-e),h=1/(r-i),u=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*h,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*h,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t},e.perspective=function(t,e,n,i,r){var s=1/Math.tan(e/2),o=1/(i-r);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*o,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),h=2/(o+a),u=2/(r+s);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*h*.5,t[9]=(r-s)*u*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t},e.ortho=function(t,e,n,i,r,s,o){var a=1/(e-n),h=1/(i-r),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*h,t[14]=(o+s)*u,t[15]=1,t},e.lookAt=function(t,e,n,r){var s=void 0,o=void 0,a=void 0,h=void 0,u=void 0,c=void 0,l=void 0,d=void 0,f=void 0,p=void 0,m=e[0],M=e[1],v=e[2],y=r[0],g=r[1],b=r[2],w=n[0],x=n[1],_=n[2];if(Math.abs(m-w)<i.EPSILON&&Math.abs(M-x)<i.EPSILON&&Math.abs(v-_)<i.EPSILON)return mat4.identity(t);l=m-w,d=M-x,f=v-_,p=1/Math.sqrt(l*l+d*d+f*f),s=g*(f*=p)-b*(d*=p),o=b*(l*=p)-y*f,a=y*d-g*l,(p=Math.sqrt(s*s+o*o+a*a))?(s*=p=1/p,o*=p,a*=p):(s=0,o=0,a=0);h=d*a-f*o,u=f*s-l*a,c=l*o-d*s,(p=Math.sqrt(h*h+u*u+c*c))?(h*=p=1/p,u*=p,c*=p):(h=0,u=0,c=0);return t[0]=s,t[1]=h,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(s*m+o*M+a*v),t[13]=-(h*m+u*M+c*v),t[14]=-(l*m+d*M+f*v),t[15]=1,t},e.targetTo=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=i[0],h=i[1],u=i[2],c=r-n[0],l=s-n[1],d=o-n[2],f=c*c+l*l+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,l*=f,d*=f);var p=h*d-u*l,m=u*c-a*d,M=a*l-h*c;return t[0]=p,t[1]=m,t[2]=M,t[3]=0,t[4]=l*M-d*m,t[5]=d*p-c*M,t[6]=c*m-l*p,t[7]=0,t[8]=c,t[9]=l,t[10]=d,t[11]=0,t[12]=r,t[13]=s,t[14]=o,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],u=t[6],c=t[7],l=t[8],d=t[9],f=t[10],p=t[11],m=t[12],M=t[13],v=t[14],y=t[15],g=e[0],b=e[1],w=e[2],x=e[3],_=e[4],A=e[5],S=e[6],R=e[7],P=e[8],L=e[9],E=e[10],I=e[11],D=e[12],O=e[13],N=e[14],Y=e[15];return Math.abs(n-g)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-b)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(s-w)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-x)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-_)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(h-A)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(u-S)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-R)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(l-P)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(d-L)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(f-E)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(p-I)<=i.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(m-D)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(M-O)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(O))&&Math.abs(v-N)<=i.EPSILON*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(y-Y)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(Y))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],p=e[11],m=e[12],M=e[13],v=e[14],y=e[15],g=n[0],b=n[1],w=n[2],x=n[3];return t[0]=g*i+b*a+w*l+x*m,t[1]=g*r+b*h+w*d+x*M,t[2]=g*s+b*u+w*f+x*v,t[3]=g*o+b*c+w*p+x*y,g=n[4],b=n[5],w=n[6],x=n[7],t[4]=g*i+b*a+w*l+x*m,t[5]=g*r+b*h+w*d+x*M,t[6]=g*s+b*u+w*f+x*v,t[7]=g*o+b*c+w*p+x*y,g=n[8],b=n[9],w=n[10],x=n[11],t[8]=g*i+b*a+w*l+x*m,t[9]=g*r+b*h+w*d+x*M,t[10]=g*s+b*u+w*f+x*v,t[11]=g*o+b*c+w*p+x*y,g=n[12],b=n[13],w=n[14],x=n[15],t[12]=g*i+b*a+w*l+x*m,t[13]=g*r+b*h+w*d+x*M,t[14]=g*s+b*u+w*f+x*v,t[15]=g*o+b*c+w*p+x*y,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=h,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=u,e.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);0!=i?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0);return n},e.multiply=c,e.rotateX=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+o*a,t[1]=r*h+s*a,t[2]=s*h-r*a,t[3]=o*h-i*a,t},e.rotateY=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h-s*a,t[1]=r*h+o*a,t[2]=s*h+i*a,t[3]=o*h-r*a,t},e.rotateZ=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+r*a,t[1]=r*h-i*a,t[2]=s*h+o*a,t[3]=o*h-s*a,t},e.calculateW=function(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},e.slerp=l,e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=d,e.fromEuler=function(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var s=Math.sin(e),o=Math.cos(e),a=Math.sin(n),h=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return t[0]=s*h*c-o*a*u,t[1]=o*a*c+s*h*u,t[2]=o*h*u-s*a*c,t[3]=o*h*c+s*a*u,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var i=a(n(0)),r=a(n(1)),s=a(n(2)),o=a(n(3));function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function h(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function u(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function c(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=i*c+o*a+r*u-s*h,t[1]=r*c+o*h+s*a-i*u,t[2]=s*c+o*u+i*h-r*a,t[3]=o*c-i*a-r*h-s*u,t}function l(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3],h=n[0],u=n[1],c=n[2],l=n[3],d=void 0,f=void 0,p=void 0,m=void 0,M=void 0;return(f=r*h+s*u+o*c+a*l)<0&&(f=-f,h=-h,u=-u,c=-c,l=-l),1-f>1e-6?(d=Math.acos(f),p=Math.sin(d),m=Math.sin((1-i)*d)/p,M=Math.sin(i*d)/p):(m=1-i,M=i),t[0]=m*r+M*h,t[1]=m*s+M*u,t[2]=m*o+M*c,t[3]=m*a+M*l,t}function d(t,e){var n=e[0]+e[4]+e[8],i=void 0;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*s+o]-e[3*o+s])*i,t[s]=(e[3*s+r]+e[3*r+s])*i,t[o]=(e[3*o+r]+e[3*r+o])*i}return t}e.clone=o.clone,e.fromValues=o.fromValues,e.copy=o.copy,e.set=o.set,e.add=o.add,e.mul=c,e.scale=o.scale,e.dot=o.dot,e.lerp=o.lerp;var f,p,m,M,v,y,g=e.length=o.length,b=(e.len=g,e.squaredLength=o.squaredLength),w=(e.sqrLen=b,e.normalize=o.normalize);e.exactEquals=o.exactEquals,e.equals=o.equals,e.rotationTo=(f=s.create(),p=s.fromValues(1,0,0),m=s.fromValues(0,1,0),function(t,e,n){var i=s.dot(e,n);return i<-.999999?(s.cross(f,p,e),s.len(f)<1e-6&&s.cross(f,m,e),s.normalize(f,f),u(t,f,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(s.cross(f,e,n),t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=1+i,w(t,t))}),e.sqlerp=(M=h(),v=h(),function(t,e,n,i,r,s){return l(M,e,r,s),l(v,n,i,s),l(t,M,v,2*s*(1-s)),t}),e.setAxes=(y=r.create(),function(t,e,n,i){return y[0]=n[0],y[3]=n[1],y[6]=n[2],y[1]=i[0],y[4]=i[1],y[7]=i[2],y[2]=-e[0],y[5]=-e[1],y[8]=-e[2],w(t,d(t,y))})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=r,e.clone=function(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var n=new i.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=s,e.multiply=o,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},e.distance=h,e.squaredDistance=u,e.length=c,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],i=e[1],r=n*n+i*i;r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r);return t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},e.lerp=function(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t},e.random=function(t,e){e=e||1;var n=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t},e.transformMat2d=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t},e.transformMat3=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t},e.transformMat4=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var n=t[0],r=t[1],s=e[0],o=e[1];return Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(){var t=new i.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function a(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function h(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)}function u(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function c(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function l(t){var e=t[0],n=t[1];return e*e+n*n}var d;e.len=c,e.sub=s,e.mul=o,e.div=a,e.dist=h,e.sqrDist=u,e.sqrLen=l,e.forEach=(d=r(),function(t,e,n,i,r,s){var o=void 0,a=void 0;for(e||(e=2),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)d[0]=t[o],d[1]=t[o+1],r(d,d,s),t[o]=d[0],t[o+1]=d[1];return t})}])},t.exports=i()},function(t,e,n){"use strict";n.r(e);var i=class{static getInstance(){return this._instance||(this._instance=new this),this._instance}static deleteInstance(){delete this._instance}};class r{}r.FirstLetterLower=function(t){return t.substring(0,1).toLowerCase()+t.substring(1,t.length).toLowerCase()},r.BindIntHandler=function(t,e){var n=r.FirstLetterLower(e);t.prototype._getInt=function(t){return Math.floor(this[t])},t.prototype._setInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(e))},t.prototype._tranInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(this[t]+e))},t.prototype._multiplyInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(this[t]*e))},t.prototype._dividedInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(this[t]/e))},t.prototype["get"+e]=function(){return this._getInt(n)},t.prototype["set"+e]=function(t){return this._setInt(n,t)},t.prototype["tran"+e]=function(t){return this._tranInt(n,t)}},r.BindDirtyIntHandler=function(t,e){var n=r.FirstLetterLower(e),i="is"+[e]+"Dirty";t.prototype._getInt=function(t){return Math.floor(this[t])},t.prototype._setInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(e))},t.prototype._tranInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(this[t]+e))},t.prototype._multiplyInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(this[t]*e))},t.prototype._dividedInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(this[t]/e))},t.prototype["get"+e]=t.prototype["get"+e]||function(){return this._getInt(n)},t.prototype["set"+e]=t.prototype["set"+e]||function(t){return this._setInt(n,t)},t.prototype["tran"+e]=t.prototype["tran"+e]||function(t){return this._tranInt(n,t)},t.prototype["_done"+e+"Dirty"]=t.prototype["_done"+e+"Dirty"]||function(){this[i]=!1}},r.BindNumberHandler=function(t,e){var n=r.FirstLetterLower(e);t.prototype._getNumber=function(t){return this[t]},t.prototype._setNumber=function(t,e){"number"==typeof e&&(this[t]=e)},t.prototype._tranNumber=function(t,e){"number"==typeof e&&(this[t]+=e)},t.prototype._multiplyNumber=function(t,e){"number"==typeof e&&(this[t]*=e)},t.prototype._dividedNumber=function(t,e){"number"==typeof e&&(this[t]/=e)},t.prototype["get"+e]=function(){return this._getNumber(n)},t.prototype["set"+e]=function(t){return this._setNumber(n,t)},t.prototype["tran"+e]=function(t){return this._tranNumber(n,t)}},r.BindDirtyNumberHandler=function(t,e){var n=r.FirstLetterLower(e),i="is"+[e]+"Dirty";t.prototype._getNumber=function(t){return this[t]},t.prototype._setNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=e)},t.prototype._tranNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]+=e)},t.prototype._multiplyNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]*=e)},t.prototype._dividedNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]/=e)},t.prototype["get"+e]=function(){return this._getNumber(n)},t.prototype["set"+e]=function(t){return this._setNumber(n,t)},t.prototype["tran"+e]=function(t){return this._tranNumber(n,t)},t.prototype["_done"+e+"Dirty"]=function(){this[i]=!1}},r.BindBoolHandler=function(t,e){var n=r.FirstLetterLower(e);t.prototype["get"+e]=function(){return!!this[n]},t.prototype["set"+e]=function(t){this[n]=!!t},t.prototype["toggle"+e]=function(t){this[n]=!t}},r.BindDirtyBoolHandler=function(t,e){var n=r.FirstLetterLower(e),i="is"+[e]+"Dirty";t.prototype["get"+e]=t.prototype["get"+e]||function(){return!!this[n]},t.prototype["set"+e]=t.prototype["set"+e]||function(t){this[i]=!0,this[n]=!!t},t.prototype["toggle"+e]=t.prototype["toggle"+e]||function(t){this[i]=!0,this[n]=!t},t.prototype["_done"+e+"Dirty"]=t.prototype["_done"+e+"Dirty"]||function(){this[i]=!1}};class s extends r{constructor(t,e){super(),this.setX(t),this.setY(e)}getXY(){return{x:this.x,y:this.y}}setXY(t,e){this._setNumber("x",t),this._setNumber("y",e)}tranXY(t,e){this._tranNumber("x",t),this._tranNumber("y",e)}assigned(t){t instanceof s&&(this.x=t.x,this.y=t.y)}copy(){return new s(this.x,this.y)}tran(){v instanceof s&&this.tranXY(v.x,v.y)}multiply(t){this.multiplyXY(t,t)}multiplyXY(t,e){this._multiplyNumber("x",t),this._multiplyNumber("y",e)}}r.BindNumberHandler(s,"X"),r.BindNumberHandler(s,"Y"),s.BindAllHandler=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"X"]=function(){return this[i].getX()},t.prototype["set"+e+"X"]=function(t){return this[s]=!0,this[i].setX(t)},t.prototype["tran"+e+"X"]=function(t){return this[s]=!0,this[i].tranX(t)},t.prototype["get"+e+"Y"]=function(){return this[i].getY()},t.prototype["set"+e+"Y"]=function(t){return this[s]=!0,this[i].setY(t)},t.prototype["tran"+e+"Y"]=function(t){return this[s]=!0,this[i].tranY(t)},t.prototype["get"+e+"XY"]=function(){return this[i].getXY()},t.prototype["set"+e+"XY"]=function(t,e){return this[s]=!0,this[i].setXY(t,e)},t.prototype["tran"+e+"XY"]=function(t,e){return this[s]=!0,this[i].tranXY(t,e)},t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[s]=!0,this[i].assigned(t)},t.prototype["tran"+e]=function(t){return this[s]=!0,this[i].tran(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}};class o extends r{constructor(t,e){super(),this.setWidth(t),this.setHeight(e)}getWH(){return{width:this.width,height:this.height}}setWH(t,e){this._setNumber("width",t),this._setNumber("height",e)}tranWH(t,e){this._tranNumber("width",t),this._tranNumber("height",e)}assigned(t){t instanceof o&&(this.width=t.width,this.height=t.height)}copy(){return new o(this.width,this.height)}tran(){v instanceof o&&this.tranWH(v.width,v.height)}toArray(){return[this.width,this.height]}}r.BindNumberHandler(o,"Width"),r.BindNumberHandler(o,"Height"),o.BindMemberHandler=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"Width"]=function(){return this[i].getWidth()},t.prototype["set"+e+"Width"]=function(t){return this[s]=!0,this[i].setWidth(t)},t.prototype["tran"+e+"Width"]=function(t){return this[s]=!0,this[i].tranWidth(t)},t.prototype["get"+e+"Height"]=function(){return this[i].getHeight()},t.prototype["set"+e+"Height"]=function(t){return this[s]=!0,this[i].setHeight(t)},t.prototype["tran"+e+"Height"]=function(t){return this[s]=!0,this[i].tranHeight(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},o.BindWHHandle=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"WH"]=function(){return this[i].getWH()},t.prototype["set"+e+"WH"]=function(t,e){return this[s]=!0,this[i].setWH(t,e)},t.prototype["tran"+e+"WH"]=function(t,e){return this[s]=!0,this[i].tranWH(t,e)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},o.BindClassHandle=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[s]=!0,this[i].assigned(t)},t.prototype["tran"+e]=function(t){return this[s]=!0,this[i].tran(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},o.BindAllHandler=function(t,e,n){o.BindMemberHandler(t,e,n),o.BindClassHandle(t,e,n),o.BindClassHandle(t,e,n)};class a{constructor(){this.node=null,this.parent=null,this.children=[],this.hasMounted=!1,this.enable=!0}addChild(t){return!t instanceof a?console.warn('"FI_Component.addChild" fail, this is not a FI_Component!'):null!==t.parent?console.warn('"FI_Component.addChild" fail, this component has been added!'):(this.children.push(t),t.parent=this,this.hasMounted&&t._tryToMount(),t)}setEnable(t){if(this.enable===!!t)return!0;this.enable=!!t,this.enable?this._onEnable():this._onDisable()}_tryToMount(){this.hasMounted||(this._tryToSetNode(this.parent.node),this._onMount())}_tryToSetNode(t){this.node||this._setNode(t)}_onMount(){this.hasMounted=!0,this._mountAllChildren(),this.onMount&&this.onMount()}_onUnmount(){this.hasMounted=!1,this.onUnmount&&this.onUnmount()}_onDisable(){this.onDisable&&this.onDisable()}_onEnable(){this.onEnable&&this.onEnable()}_mountAllChildren(){this.children.map(t=>t._tryToMount())}_setNode(t){return!t instanceof h?console.warn("FI_Component","can not mount on invaild node! node:",t):(this.node=t,t)}_onUpdate(t){return!1!==this.enable&&(this.children.map(e=>e._onUpdate(t)),!0)}_onRender(t){return!1!==this.enable&&(this.children.map(e=>e._onRender(t)),!0)}debugDraw(){}}class h extends r{constructor(){super(),this.children=[],this.components=[],this.actions=[],this.level=0,this.parent=null,this.enable=!0,this.visible=1,this.hasAdded=!1}getParent(){return this.parent}addComponent(t){if(!(!t instanceof a))return this.components.push(t),t._setNode(this),this.hasAdded&&t._onMount(),t;console.log('"addComponent fail! This is not a component! "')}setEnable(t){if(this.enable===!!t)return!0;this.enable=!!t,this.enable?this._onEnable():this._onDisable()}_onAdded(){this.hasAdded=!0,this._mountAllComponent(),this.onAdded&&this.onAdded()}_onRemoved(){this.hasAdded=!1,this._removeAllComponents(),this.onRemoved&&this.onRemoved()}_onUpdate(t){this.onUpdate&&this.onUpdate(t)}_onRender(t){this.onRender&&this.onRender(t)}_onEnable(){this.onEnable&&this.onEnable()}_onDisable(){this.onDisable&&this.onDisable()}_mountAllComponent(){this.components.map(t=>!t.hasMounted&&t._onMount())}_removeAllComponents(){this.components.map(t=>t.hasMounted&&t._onUnmount()),this.components=[]}_setAllComponentsEnable(t){this.components.map(e=>e.setEnable(t))}}r.BindDirtyIntHandler(h,"Level"),r.BindDirtyBoolHandler(h,"Enable"),r.BindDirtyBoolHandler(h,"Visible");class u extends h{constructor(){super(),this.position=new s(0,0),this.anchor=new s(.5,.5),this.size=new o(0,0),this.scale=new s(1,1),this.rotation=0}getAnchorOffset(){return{x:this.anchor.x*this.size.width,y:this.anchor.y*this.size.height}}addChild(t){return t.getParent()?console.warn("has been added !"):(this.children.push(t),t.parent=this,t.setLevel(this.level+1),t._onAdded(),t)}removeChild(t){for(var e=0;e<this.children.length;++e)if(this.children[e]==t)return void this.children.splice(e,1).onRemoved()}removeComponent(t){for(var e=0;e<this.components.length;++e)if(this.components[e]==t)return this.components.splice(e,1),void(t.hasMounted&&t._onUnmount())}addAction(t){return this.actions.push(t),t._setNode(this),t}removeAction(t){for(var e=0;e<this.actions.length;++e)if(this.actions[e]==t)return void this.actions.splice(e,1)}removeAllActions(){this.actions=[]}_onUpdate(t){this.enable&&(this.onUpdate&&this.onUpdate(t),this.actions.map(e=>e._onUpdate(t)),this.components.map(e=>e._onUpdate(t)),this.children.map(e=>e._onUpdate(t)))}_onRender(t){this.visible&&(t.translate(this.position.x,this.position.y),t.rotate(this.rotation*Math.PI/180),t.scale(this.scale.x,this.scale.y),t.save(),this.components.map(e=>{e._onRender(t),t.restore(),t.save()}),this.children.map(e=>{e._onRender(t),t.restore(),t.save()}),t.restore(),this._doneTransformsDirty(),this._doneLevelDirty(),this._doneEnableDirty())}isTransformsDirty(){return this.isPositionDirty||this.isScaleDirty||this.isRotationDirty||this.isSizeDirty}_doneTransformsDirty(){this._donePositionDirty(),this._doneScaleDirty(),this._doneAnchorDirty(),this._doneSizeDirty()}debugDraw(t){}}s.BindAllHandler(u,"Position"),s.BindAllHandler(u,"Scale"),s.BindAllHandler(u,"Anchor"),o.BindMemberHandler(u,"Size",!0),o.BindWHHandle(u,"Size"),o.BindClassHandle(u,"Size"),r.BindDirtyNumberHandler(u,"Rotation");class c extends u{static getInstance(){return this.instance||(this.instance=new c),this.instance}constructor(){super(),this.curIndex=0,this.enable=!0}run(t){this.addChild(t)}push(t){this.children[this.curIndex].setEnable(!1),this.children[this.curIndex].setVisible(!1),++this.curIndex,this.addChild(t)}back(){}}const l=function(t){return"[object Array]"===function(t){return Object.prototype.toString.call(t)}(t)},d=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=e.createSVGMatrix(),i=[];t.getTransform=function(){return n};var r=t.save;t.save=function(){return i.push(n.translate(0,0)),r.call(t)};var s=t.restore;t.restore=function(){return n=i.pop(),s.call(t)};var o=t.scale;t.scale=function(e,i){return n=n.scaleNonUniform(e,i),o.call(t,e,i)};var a=t.rotate;t.rotate=function(e){return n=n.rotate(e),a.call(t,e)};var h=t.translate;t.translate=function(e,i){return n=n.translate(e,i),h.call(t,e,i)};var u=t.transform;t.transform=function(i,r,s,o,a,h){var c=e.createSVGMatrix();return c.a=i,c.b=r,c.c=s,c.d=o,c.e=a,c.f=h,n=n.multiply(c),u.call(t,i,r,s,o,a,h)};var c=t.setTransform;t.setTransform=function(e,i,r,s,o,a){return n.a=e,n.b=i,n.c=r,n.d=s,n.e=o,n.f=a,c.call(t,e,i,r,s,o,a)};var l=e.createSVGPoint();t.transformedPoint=function(t,e){return l.x=t,l.y=e,l.matrixTransform(n.inverse())};var d=e.createSVGPoint();t.transformedPoint2=function(t,e){return d.x=t,d.y=e,d.matrixTransform(n)};var f=t.clearRect;t.clearRect=function(e,n,i,r){t.save(),t.setTransform(1,0,0,1,0,0),f.call(t,e,n,i,r),t.restore()}};class f extends r{constructor(t,e,n,i){super(),this.setR(t),this.setG(e),this.setB(n),this.setA(i)}assigned(t){t instanceof f&&(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a)}copy(){return new f(this.r,this.g,this.b,this.a)}toString(){return`rgba(${Math.floor(255*this.r)},${Math.floor(255*this.g)},${Math.floor(255*this.b)},${this.a})`}toArray(){return[this.r,this.g,this.b,this.a]}}r.BindNumberHandler(f,"R"),r.BindNumberHandler(f,"G"),r.BindNumberHandler(f,"B"),r.BindNumberHandler(f,"A"),f.BindAllHandler=function(t,e,n){var i=r.FirstLetterLower(e);t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[dirtyName]=!0,this[i].assigned(t)}};var p=n(0);class m extends r{constructor(){super(),this.vertixPositions=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];var t=[[1,1,1,1],[1,0,0,1],[0,1,0,1],[0,0,1,1],[1,1,0,1],[1,0,1,1]];this.vertixColors=[];for(var e=0;e<t.length;++e){const n=t[e];this.vertixColors=this.vertixColors.concat(n,n,n,n)}}initBuffers(t){const e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertixPositions),t.STATIC_DRAW);const n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertixColors),t.STATIC_DRAW);const i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i);return t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),t.STATIC_DRAW),{position:e,color:n,indices:i}}_onRender(t){}}var M=1;class y extends i{constructor(){super(),this.setBackgroundColor(0,0,0),this.setMode("3d"),this.setSize(800,600),this.lastUpdateTime=0,this.rootNode=c.getInstance()}getSize(){return this.size}setSize(t,e){return this.size=new o(t,e),this}setBackgroundColor(t,e,n,i=1){return this.backgroundColor=new f(t,e,n,i),this}setMode(t="3d"){this.mode=t}launch(t){"3d"===this.mode&&(this.canvas3d=document.createElement("canvas"),this.canvas3d.style.position="absolute",t.appendChild(this.canvas3d),this.webgl=this.canvas3d.getContext("webgl")),this.canvas2d=document.createElement("canvas"),this.canvas2d.style.position="absolute",t.appendChild(this.canvas2d),this.setSize(800,600),this.ctx2d=this.canvas2d.getContext("2d"),this.ctxTracker=d(this.ctx2d);const e=this.initShaderProgram(this.webgl,"\n      attribute vec4 aVertexPosition;\n      attribute vec4 aVertexColor;\n      uniform mat4 uModelViewMatrix;\n      uniform mat4 uProjectionMatrix;\n      varying lowp vec4 vColor;\n      void main() {\n        gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n        vColor = aVertexColor;\n      }\n    ","\n      varying lowp vec4 vColor;\n      void main() {\n        gl_FragColor = vColor;\n      }\n    ");return this.programInfo={program:e,attribLocations:{vertexPosition:this.webgl.getAttribLocation(e,"aVertexPosition"),vertexColor:this.webgl.getAttribLocation(e,"aVertexColor")},uniformLocations:{projectionMatrix:this.webgl.getUniformLocation(e,"uProjectionMatrix"),modelViewMatrix:this.webgl.getUniformLocation(e,"uModelViewMatrix")}},this.cube=new m,this.buffers=this.cube.initBuffers(this.webgl),console.log(this.buffers),this.looper(0),this}loadShader(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert("An error occurred compiling the shaders: "+t.getShaderInfoLog(i)),t.deleteShader(i),null)}initShaderProgram(t,e,n){const i=this.loadShader(t,t.VERTEX_SHADER,e),r=this.loadShader(t,t.FRAGMENT_SHADER,n),s=t.createProgram();return t.attachShader(s,i),t.attachShader(s,r),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)?s:(alert("Unable to initialize the shader program: "+t.getProgramInfoLog(s)),null)}initBuffers(t){const e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e);t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW);const n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,1,1,1,0,0,1,0,1,0,1,0,0,1,1]),t.STATIC_DRAW),{position:e,color:n}}drawScene(t,e,n,i){t.clearColor(0,0,0,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const r=45*Math.PI/180,s=t.canvas.clientWidth/t.canvas.clientHeight,o=p.mat4.create();p.mat4.perspective(o,r,s,.1,100);const a=p.mat4.create();p.mat4.translate(a,a,[-0,0,-6]),p.mat4.rotate(a,a,M,[0,0,1]),p.mat4.rotate(a,a,.7*M,[0,1,0]);{const i=3,r=t.FLOAT,s=!1,o=0,a=0;t.bindBuffer(t.ARRAY_BUFFER,n.position),t.vertexAttribPointer(e.attribLocations.vertexPosition,i,r,s,o,a),t.enableVertexAttribArray(e.attribLocations.vertexPosition)}{const i=4,r=t.FLOAT,s=!1,o=0,a=0;t.bindBuffer(t.ARRAY_BUFFER,n.color),t.vertexAttribPointer(e.attribLocations.vertexColor,i,r,s,o,a),t.enableVertexAttribArray(e.attribLocations.vertexColor)}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indices),t.useProgram(e.program),t.uniformMatrix4fv(e.uniformLocations.projectionMatrix,!1,o),t.uniformMatrix4fv(e.uniformLocations.modelViewMatrix,!1,a);{const e=36,n=t.UNSIGNED_SHORT,i=0;t.drawElements(t.TRIANGLES,e,n,i)}M+=.01}looper(t){this._onUpdate(t-this.lastUpdateTime),this._onRender(),this.lastUpdateTime=t,window.requestAnimationFrame(this.looper.bind(this))}_onUpdate(t){this.canvas3d&&(this.canvas3d.width=this.size.width,this.canvas3d.height=this.size.height),this.canvas2d&&(this.canvas2d.width=this.size.width,this.canvas2d.height=this.size.height),this.rootNode&&this.rootNode._onUpdate(t)}_onRender(){this.ctx2d&&this.ctx2d.clearRect(0,0,...this.size.toArray()),"2d"===this.mode?this.ctx2d&&(this.ctx2d.fillStyle=this.backgroundColor.toString(),this.ctx2d.fillRect(0,0,...this.size.toArray())):this.webgl&&this.drawScene(this.webgl,this.programInfo,this.buffers),this.rootNode._onRender(this.ctx2d)}}class g{constructor(t,e,n){this.name=t,this.func=e,this.priority=n}setEventCenter(t){this.eventCenter=t}removeSelf(){this.eventCenter&&this.eventCenter.removeListener(this)}}class b extends i{constructor(){super(),this.listeners={}}dispatch(t,e){var n=this.getListeners(t);for(var i in n)if(n[i].func(e))break}getListeners(t){return this.listeners[t]}addListener(t,e,n){var i=this.listeners[t]||[];if(i){var r=new g(t,e,n);return r.setEventCenter(this),i.push(r),i.sort((t,e)=>e.priority-t.priority),this.listeners[t]=i,r}}removeListener(t){for(var e=this.getListeners(t.name),n=0;n<e.length;++n)if(e[n]===t){e.splice(n,1);break}}_onUpdate(t){this.opUpdate&&this.opUpdate(t)}}class w extends b{constructor(){super()}launch(){document.addEventListener("keydown",this.onKeyDown.bind(this),!1),document.addEventListener("keyup",this.onKeyUp.bind(this),!1)}onKeyDown(t){this.dispatch("keydown",t)}onKeyUp(t){this.dispatch("keyup",t)}onUpdate(t){}}class x extends b{constructor(){super()}launch(){document.addEventListener("mousedown",this.onMouseDown.bind(this),!1),document.addEventListener("mouseup",this.onMouseUp.bind(this),!1),document.addEventListener("mousemove",this.onMouseMove.bind(this),!1)}onMouseDown(t){this.dispatch("mousedown",t)}onMouseUp(t){this.dispatch("mouseup",t)}onMouseMove(t){this.dispatch("mousemove",t)}}class _{onAssign(){}onFinish(){}_setNode(t){this.node=t,this.onAssign()}_onUpdate(){}}class A extends _{constructor(t,e){super(),this.value=t,this.duration=e,this.time=e}onAssign(){this.endValue=this.node.getRotation()+this.value,this.speed=this.value/this.duration}onFinish(){this.node.setRotation(this.endValue),this.node.removeAction(this)}_onUpdate(t){var e=this.node.getRotation();this.node.setRotation(e+this.speed*t),this.time-=t,this.time<=0&&this.onFinish()}}var S=new class{constructor(){this.images={}}firstLoadImage(t){return new Promise((e,n)=>{var i=new Image;i.src=t,i.onload=(()=>{for(var n in this.images[t])this.images[t][n].onload(i);return this.images[t]=i,e(i)}),i.onerror=(e=>{for(var i in this.images[t])this.images[t][i].onerror(e);return delete this.images[t],n(e)})})}loadImage(t){return new Promise((e,n)=>{this.images[t].push({onload:e,onerror:n})})}getImage(t){var e=this.images[t];return e?l(e)?this.loadImage(t):Promise.resolve(e):(this.images[t]=[],this.firstLoadImage(t))}};class R{static intersectWith(t,e){var n=Math.max(t.x,e.x),i=Math.min(t.x+t.w,e.x+e.w)-n;if(i<0)return null;var r=Math.max(t.y,e.y),s=Math.min(t.y+t.h,e.y+e.h)-r;return s<0?null:new R(n,r,i,s)}constructor(t,e,n,i){this.x=t,this.y=e,this.w=n,this.h=i}intersectWith(t){return R.intersectWith(this,t)}}class P extends a{constructor(t){super(),this.imageUri=t,this.texRect=null,this.scale=new s(1,1),this.flap=new s(1,1)}setScale(t){this.scale=t}setFlap(t){this.flap=t}onMount(){this.imageUri&&this._loadImage(this.imageUri)}setTexRect(t){this.texRect=t}setImage(t){this.image=t}async _loadImage(t){try{this.image=await S.getImage(t),this.texRect=this.texRect||{x:0,y:0,width:this.image.width,height:this.image.height}}catch(t){console.warn(t)}}_onRender(t){if(!super._onRender(t))return!1;if(this.image&&this.texRect&&this.node){var e=this.node.getAnchorOffset();t.scale(this.scale.x*this.flap.x,this.scale.y*this.flap.y),t.drawImage(this.image,this.texRect.x,this.texRect.y,this.texRect.width,this.texRect.height,-e.x,-e.y,this.node.size.width,this.node.size.height)}return!0}}class L extends P{constructor(){super(null),this.scale=new s(1,1),this.flap=new s(1,1)}init(t,e,n){this.setDuration(e),this.setImage(t),this.setTexRect(n)}setDuration(t){this.duration=t}getDuration(){return this.duration}}class E extends a{constructor(){super(),this.curIndex=0,this.curTime=0,this.isAutoReset=!0,this.loop=0,this.curLoop=0,this.scale=new s(1,1),this.flap=new s(1,1)}setScale(t){this.scale=t,this.curFrame&&this.curFrame.setScale(t)}setFlap(t){this.flap=t,this.curFrame&&this.curFrame.setFlap(t)}play(){this.playing=!0}stop(){this.playing=!1}setAutoReset(t){this.isAutoReset=t}setLoop(t){this.loop=t}onLoopFinish(){}onFinish(){}_onUpdate(t){if(this.playing){var e=this.children[this.curIndex];if(e)if(this.curTime+=t,e._onUpdate(t),this.curTime-e.getDuration()>=0){this.curTime=0;var n=this.curIndex+1;n>=this.children.length&&(0==this.loop?n=0:this.curLoop>=this.loop?(this.curLoop+=1,n=0):(n=this.children.length-1,this.stop())),n!==this.curIndex&&(this.curIndex=n,this.curFrame=this.children[n],this.curFrame.setScale(this.scale),this.curFrame.setFlap(this.flap))}}}_onRender(t){this.curFrame&&this.curFrame._onRender(t)}}var I=new class{constructor(){this.imagesCache={}}getImage(t){return this.imagesCache[t]||(this.imagesCache[t]=new P(t)),this.imagesCache[t]}async createWithData(t){for(var e=new E,n=0;n<t.frames.length;++n){var i=t.frames[n],r=e.addChild(new L);try{var s=await S.getImage(i.image||t.image);r.init(s,i.duration||t.duration,i.rect)}catch(t){console.warn(t)}}return e.setLoop(t.loop),e}};class D extends a{constructor(){super(),this.jumpable=!1,this.walkDirection=0,this.jumpSpeed=0,this.walkSpeed=0,this.walkAcc=0,this.gavity=0,this.ground=0}jump(){this.jumpable&&this.mover.setVelocityY(this.jumpSpeed)}walk(t){this.walkDirection=t?t/Math.abs(t):0}setJumpSpeed(t){this.jumpSpeed=t}setWalkSpeed(t){this.walkSpeed=Math.abs(t)}setWalkAcc(t){this.walkAcc=Math.abs(t)}setGavity(t){this.gavity=t}setGround(t){this.ground=t}setMover(t){this.mover=t}setRect(t){this.rect=t}onMount(){this.mover&&this.mover._setNode(this.node)}_onUpdate(t){if(this.mover){this.mover._onUpdate(t);var e=this.node.getPositionY(),n=0;e<this.ground&&(n=this.mover.tranVelocityY(this.gavity)*t/1e3,this.jumpable=!1),e+n>this.ground&&(this.node.setPositionY(this.ground),this.mover.setVelocityY(0),this.jumpable=!0);var i=this.walkDirection,r=this.walkSpeed,s=this.walkAcc;if(r&&s)if(i){var o=this.mover.getVelocityX();this.mover.tranVelocityX(i*(s-Math.abs(o*s/r))),(i>0&&o<0||i<0&&o>0)&&this.mover.decayVelocityX(s)}else this.mover.decayVelocityX(s)}}}class O extends a{constructor(t){super(),this.content="Hello",this.anchor=new s(0,.5),this.fontSize=24,this.fontSizeUnit="px",this.fontFamily="Arial",this.textAlign="center",this.fillStyle="white",this.strokeStyle="gray",this.offset=new s(0,0),this.size=new o(0,this.fontSize)}onMount(){}_onSizeChange(t,e){this.setSizeWH(t,e),this.onSizeChange&&this.onSizeChange(this)}_onRender(t){t.fillStyle=this.fillStyle,t.strokeStyle=this.strokeStyle,t.font=this.fontSize+this.fontSizeUnit+" "+this.fontFamily,t.textAlign=this.textAlign;var e=t.measureText(this.content);e.width==this.size.width&&e.height==this.size.height||this._onSizeChange(e.width,this.fontSize),this.fillStyle&&t.fillText(this.content,this.offset.x+this.anchor.x*this.size.width,this.offset.y+this.anchor.y*this.size.height),this.strokeStyle&&t.strokeText(this.content,this.offset.x+this.anchor.x*this.size.width,this.offset.y+this.anchor.y*this.size.height)}}s.BindAllHandler(O,"Offset"),o.BindMemberHandler(O,"Size",!0),o.BindWHHandle(O,"Size"),o.BindClassHandle(O,"Size");class N extends a{onMount(){this.mousedownListener=x.getInstance().addListener("mousedown",this._onGlobalMouseDown.bind(this),this.node.getLevel()),this.mouseupListener=x.getInstance().addListener("mouseup",this._onGlobalMouseUp.bind(this),this.node.getLevel()),this.mousemoveListener=x.getInstance().addListener("mousemove",this._onGlobalMouseMove.bind(this),this.node.getLevel())}onUnmount(){this.mousedownListener.removeSelf(),this.mouseupListener.removeSelf(),this.mousemoveListener.removeSelf()}_getCurrentIsMouseOnMe(t){if(!t)return!1;var e=this.node.getAnchorOffset(),n=this.transform.e-e.x*this.node.scale.x,i=n+this.node.size.width*this.node.scale.x,r=this.transform.f-e.y*this.node.scale.y,s=r+this.node.size.height*this.node.scale.y;return this.mousePosition={x:-this.transform.e+t.clientX,y:-this.transform.f+t.clientY},t.clientX>=n&&t.clientX<=i&&t.clientY>=r&&t.clientY<=s}_onGlobalMouseMove(t){t&&(this._getCurrentIsMouseOnMe(t)?(!this.isMouseOnMe&&this.onMouseOut&&this.onMouseIn(this.mousePosition),this.isMouseOnMe=!0,this._onMouseMove(t)):(this.isMouseOnMe&&this.onMouseOut&&this.onMouseOut(this.mousePosition),this.isMouseOnMe=!1))}_onMouseMove(t){this.enable&&this.onMouseMove&&this.onMouseMove(this.mousePosition)}_onGlobalMouseDown(t){var e=this._getCurrentIsMouseOnMe(t);this.enable&&e&&this.onMouseDown&&this.onMouseDown(this.mousePosition)}_onGlobalMouseUp(t){var e=this._getCurrentIsMouseOnMe(t);this.enable&&e&&this.onMouseUp&&this.onMouseUp(this.mousePosition)}_onRender(t){this.debugDraw(t),this.transform=t.getTransform()}}class Y extends _{constructor(t,e,n){super(),this.valueX=t,this.valueY=e,this.duration=n,this.time=n}onAssign(){this.speedX=(this.valueX-this.node.getScaleX())/this.duration,this.speedY=(this.valueY-this.node.getScaleY())/this.duration}onFinish(){this.node.setScaleX(this.valueX),this.node.setScaleY(this.valueY),this.node.removeAction(this)}_onUpdate(t){this.node.tranScaleX(this.speedX*t),this.node.tranScaleY(this.speedY*t),this.time-=t,this.time<=0&&this.onFinish()}}class C extends u{constructor(t){super(),this.textContent=t}onAdded(){var t=this.addChild(new u),e=t.addChild(new u).addComponent(new O);e.content=this.textContent,e.onSizeChange=(t=>{this.size.width=t.size.width,this.size.height=t.size.height});var n=this.addComponent(new N);n.onMouseIn=(e=>{t.removeAllActions(),t.addAction(new Y(1.1,1.1,250)),this.onMouseIn&&this.onMouseIn()}),n.onMouseOut=(e=>{t.removeAllActions(),t.addAction(new Y(1,1,250)),this.onMouseOut&&this.onMouseOut()}),n.onMouseDown=(e=>{t.removeAllActions(),t.addAction(new Y(1,1,50)),this.onMouseDown&&this.onMouseDown()}),n.onMouseUp=(e=>{t.removeAllActions(),t.addAction(new Y(1.1,1.1,50)),this.onMouseUp&&this.onMouseUp()})}}class F extends a{constructor(){super(),this.velocity=new s(0,0)}getVelocity(){return this.velocity}setVelocity(t,e){this.velocity=new s(t,e)}tranVelocity(t,e){return this.velocity.x+=t,this.velocity.y+=e,this.velocity}getVelocityX(){return this.velocity.x}setVelocityX(t){return this.velocity.x=t,this.velocity.x}tranVelocityX(t){return this.velocity.x+=t,this.velocity.x}decayVelocityX(t){this.velocity.x>0?(this.velocity.x-=Math.abs(t),this.velocity.x=Math.max(0,this.velocity.x)):this.velocity.x<0&&(this.velocity.x+=Math.abs(t),this.velocity.x=Math.min(0,this.velocity.x))}getVelocityY(){return this.velocity.y}setVelocityY(t){return this.velocity.y=t,this.velocity.y}tranVelocityY(t){return this.velocity.y+=t,this.velocity.y}decayVelocityY(t){this.velocity.y>0?(this.velocity.y-=Math.abs(t),this.velocity.y=Math.max(0,this.velocity.y)):this.velocity.y<0&&(this.velocity.y+=Math.abs(t),this.velocity.y=Math.min(0,this.velocity.y))}onMount(){}_onUpdate(t){this.node.tranPositionX(this.velocity.x*t/1e3),this.node.tranPositionY(this.velocity.y*t/1e3)}_onRender(t){}}class T extends a{constructor(){super(),this.animations={},this.scale=new s(1,1),this.flap=new s(1,1)}setScale(t){this.scale=t,this.curAnimation&&this.curAnimation.setScale(t)}setFlap(t){this.flap=t,this.curAnimation&&this.curAnimation.setFlap(t)}async addAnimationWithData(t){var e=await I.createWithData(t);this.addChild(e),this.animations[t.name]=e}playAnaimtion(t){this.animations[t]&&(this.curAnimation=this.animations[t],this.curAnimation.play(),this.curAnimation.setScale(this.scale),this.curAnimation.setFlap(this.flap))}_onUpdate(t){return!!this.enable&&(this.curAnimation&&this.curAnimation._onUpdate(t),!0)}_onRender(t){return!!this.enable&&(this.curAnimation&&this.curAnimation._onRender(t),!0)}}class k extends u{constructor(){super(),this.gavity=60,this.size.width=100,this.size.height=100,this.position.x=400,this.position.y=300,this.anchor.x=.5,this.anchor.y=0;var t=new D;t.setMover(new F),t.setRect(new R(0,0,100,100)),t.setGavity(this.gavity),t.setGround(500),t.setJumpSpeed(-1e3),t.setWalkSpeed(120),t.setWalkAcc(50),this.actor2d=this.addComponent(t),this.animator=this.addComponent(new T),this.animator.addAnimationWithData({name:"genji_standing",loop:0,duration:120,image:"../textures/template.png",frames:[{rect:{x:0,y:0,width:79,height:79}},{rect:{x:80,y:0,width:79,height:79}},{rect:{x:160,y:0,width:79,height:79}},{rect:{x:240,y:0,width:79,height:79}}]}),this.animator.addAnimationWithData({name:"genji_running",loop:0,duration:90,image:"../textures/template.png",frames:[{rect:{x:0,y:160,width:79,height:79}},{rect:{x:80,y:160,width:79,height:79}},{rect:{x:160,y:160,width:79,height:79}},{rect:{x:80,y:160,width:79,height:79}}]}),this.animator.addAnimationWithData({name:"genji_walking",loop:0,duration:120,image:"../textures/template.png",frames:[{rect:{x:320,y:0,width:79,height:79}},{rect:{x:400,y:0,width:79,height:79}},{rect:{x:480,y:0,width:79,height:79}},{rect:{x:560,y:0,width:79,height:79}},{rect:{x:480,y:0,width:79,height:79}},{rect:{x:400,y:0,width:79,height:79}}]}),this.animator.playAnaimtion("genji_standing")}jump(){this.actor2d.jump()}walk(t){t?(this.animator.playAnaimtion("genji_walking"),this.animator.flap.x=t):this.animator.playAnaimtion("genji_standing"),this.actor2d.walk(t)}run(t){if(this.isRunning)return!1;t?(this.animator.playAnaimtion("genji_running"),this.animator.flap.x=t,this.isRunning=!0,this.actor2d.setWalkSpeed(240),this.actor2d.setWalkAcc(100)):this.animator.playAnaimtion("genji_standing"),this.actor2d.walk(t)}stopRunning(){this.isRunning=!1,this.actor2d.setWalkSpeed(120),this.actor2d.setWalkAcc(50)}onUpdate(){this.isRunning&&this.actor2d.walk(this.animator.flap.x)}}const B=R,U=s,q=u,H=class extends u{constructor(){super();var t=y.getInstance().getSize();this.setWidth(t.width),this.setHeight(t.height)}goto(t){c.getInstance().push(new t)}},j=class extends a{constructor(){super(),this.items=[],this.isDirty=!0}add(t){return this.items.push(t),t}remove(t){for(var e=0;e<this.items.length;++e)if(this.items[e]===t){this.items.splice(e,1);break}}onMount(){}_onRender(t){this.isDirty=!1;var e=this.node.getAnchorOffset();this.items.map(n=>{var{fill:i,stroke:r,fillStyle:s,strokeStyle:o,width:a,close:h,style:u,type:c}=n;switch(t.fillStyle=s||"transparent",t.strokeStyle=o||"gray",t.lineWidth=a||1,t.beginPath(),c){case"lines":var{points:l}=n;l.map((n,i)=>{0===i?t.moveTo(n.x-e.x,n.y-e.y):t.lineTo(n.x-e.x,n.y-e.y)});break;case"rect":var{x:d,y:f,w:p,h:m}=n;t.rect(d-e.x,f-e.y,p,m);break;case"circle":var{x:d,y:f,r:M}=n;t.arc(d-e.x,f-e.y,M,0,2*Math.PI)}r&&t.stroke(),i&&t.fill(),h&&t.closePath()})}},z=P,V=F,X=class extends a{constructor(){super()}onMount(){this._initKeyboard()}_initKeyboard(){this.isListeningKeyboard||(this.isListeningKeyboard=!0,w.getInstance().addListener("keydown",this._onKeyDown.bind(this),!1),w.getInstance().addListener("keyup",this._onKeyUp.bind(this),!1),this.foucsingKeys={},this.plisteners={},this.klisteners={},this.rlisteners={},this.dklisteners={},this.dclisteners={},this.dckeytimess={})}_onKeyDown(t){if("number"==typeof this.foucsingKeys[t.key])switch(this.foucsingKeys[t.key]){case-1:case 0:this.foucsingKeys[t.key]=1,this.dckeytimess[t.key]&&this.dckeytimess[t.key].push(t.timeStamp)}}_onKeyUp(t){if("number"==typeof this.foucsingKeys[t.key])switch(this.foucsingKeys[t.key]){case 1:case 2:this.foucsingKeys[t.key]=0,this.dckeytimess[t.key]&&this.dckeytimess[t.key].push(t.timeStamp)}}onKeyDoubleClick(t,e){this.foucsingKeys[t]=-1,this.dclisteners[t]=e,this.dckeytimess[t]=[]}onKeyPress(t,e){this.foucsingKeys[t]=-1,this.plisteners[t]=e}onKeyRelease(t,e){this.foucsingKeys[t]=-1,this.rlisteners[t]=e}onKeyKeepPress(t,e){this.foucsingKeys[t]=-1,this.klisteners[t]=e}onDirectionKeepPress(t,e,n){this.foucsingKeys[t]=-1,this.foucsingKeys[e]=-1,this.dklisteners[t+"_"+e]=n}_onUpdate(t){if(this.isListeningKeyboard){for(var e in this.dklisteners){var n=e.split("_");this.dklisteners[e](this.foucsingKeys[n[1]]-this.foucsingKeys[n[0]],t)}for(var e in this.foucsingKeys){switch(this.foucsingKeys[e]){case 0:this.foucsingKeys[e]--,this.rlisteners[e]&&this.rlisteners[e](t);break;case 1:this.foucsingKeys[e]++,this.plisteners[e]&&this.plisteners[e](t);break;case 2:this.klisteners[e]&&this.klisteners[e](t)}this.dckeytimess[e]&&4==this.dckeytimess[e].length&&(this.dckeytimess[e][3]-this.dckeytimess[e][0]<=500&&this.dclisteners[e]&&this.dclisteners[e](),this.dckeytimess[e]=[])}}}};var W=document.getElementById("app");y.getInstance().launch(W).setSize(1366,768),w.getInstance().launch(),x.getInstance().launch(),c.getInstance().run(new class extends H{constructor(){super(),this.gavity=60,this.speedY=0,this.pressUp=0,this.pressDown=0,this.pressRight=0,this.pressLeft=0,this.pressJump=0,this.pressAttack=0,this.pressFn=0,this.ud=0,this.lr=0}onUpdate(t){}createBullet(t){var e=new q;e.setSizeWH(25,25),e.setPosition(this.genji.getPosition()),e.addComponent(new z("../../textures/moon_1024.jpg"));var n=e.addComponent(new V);n.tranVelocityX(1600*Math.sin(t)),n.tranVelocityY(1600*Math.cos(t)),e.addAction(new A(1e4,1e4)),console.log(e),this.addChild(e)}getShotAngle(){var t=this.ud,e=this.lr,n=90;return 1==e?1==t?n-=45:-1==t&&(n+=45):-1==e?(n=-90,1==t?n+=45:-1==t&&(n-=45)):1==t?n=0:-1==t&&(n=180),n}rightShot(){var t=this.getShotAngle();this.createBullet((t+10)*Math.PI/180),this.createBullet(t*Math.PI/180),this.createBullet((t-10)*Math.PI/180),setTimeout(()=>{this.shotting=!1},500)}leftShot(){this.count=this.count||0,this.count++;var t=this.getShotAngle();this.createBullet(t*Math.PI/180),this.count<3?setTimeout(this.leftShot.bind(this),100):setTimeout(()=>{this.shotting=!1,this.count=0},500)}onAdded(){this.stage2D=new q;var t,e=this.stage2D.addComponent(new j),n=new B(0,600,1e3,100),i=new B(10,610,900,50),r=n.intersectWith(i);e.add({type:"lines",color:"#FF0000",stroke:!0,fill:!0,width:1,points:[new U(0,0),new U(100,100),new U(100,0)]}),e.add({color:"#FF0000",stroke:!0,fill:!0,type:"rect",x:n.x,y:n.y,w:n.w,h:n.h}),e.add({color:"#FF0000",stroke:!0,fill:!0,type:"rect",x:i.x,y:i.y,w:i.w,h:i.h}),r&&e.add({color:"#00FF00",stroke:!0,fill:!0,type:"rect",x:r.x,y:r.y,w:r.w,h:r.h}),this.addChild(this.stage2D),this.genji=this.addChild(new k),this.buttonLayer=new q,this.buttonLayer.setPositionXY(300,0),(t=new C("Sprite & Action")).setPositionXY(400,300),this.buttonLayer.addChild(t),(t=new C("Button")).setPositionXY(400,350),t.onMouseUp=(()=>{this.setScaleXY(.8*this.getScaleX(),1)}),this.buttonLayer.addChild(t),this.addChild(this.buttonLayer);var s=this.addComponent(new X);s.onKeyPress("k",()=>this.genji.jump()),s.onDirectionKeepPress("w","s",(t,e)=>{t/=t?Math.abs(t):1,this.ud=t}),s.onDirectionKeepPress("a","d",(t,e)=>{t/=t?Math.abs(t):1,this.genji.isRunning?this.lr==-1*t&&(this.lr=t,this.genji.stopRunning()):(this.lr=t,this.genji.walk(t))}),s.onKeyDoubleClick("a",()=>{!this.genji.isRunning&&this.genji.run(-1)}),s.onKeyDoubleClick("d",()=>{!this.genji.isRunning&&this.genji.run(1)}),s.onKeyPress("l",()=>{this.pressFn=1}),s.onKeyRelease("l",()=>{this.pressFn=1}),s.onKeyKeepPress("j",()=>{this.shotting||(this.shotting=!0,1==this.pressFn?this.rightShot():this.leftShot())})}onRemoved(){}})}]);